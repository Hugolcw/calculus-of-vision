# 📋 Project Sobel 视频全量视觉病理报告 (终极版)

**对应代码版本**：V12 (`sobel_v12_full.py`)  
**文档编号**：V12

患者版本：V12 (sobel_v12_full.py)

诊断标准：Challenge Cup / 3Blue1Brown 级精品科普

总计病灶：27 处 (含 7 处重大事故)

---

### 🏥 一、 全局性基础病 (Infrastructure Issues)

*这些问题贯穿全片，是导致“廉价感”的根源。*

| **编号** | **症状描述 (Symptom)** | **病理诊断 (Pathology)**                                                   | **V13 处方 (Prescription)**                                                              | **严重度** |
| -------------- | ---------------------------- | -------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------- | ---------------- |
| **#01**  | **配色刺眼/廉价**      | 直接使用了 Manim 原生高饱和色 (`RED`,`YELLOW`)，导致视觉疲劳且缺乏电影质感。 | **重构 `utils.py`** ：建立语义化色板，使用 `#F1C40F`(琥珀金) 替红，`#0F1115`替黑。 | 🟡 中            |
| **#02**  | **安全区溢出**         | 多个场景的元素贴边或被切（如 Scene 0 三图并列），未考虑屏幕边缘余量。            | **布局引擎** ：定义 `SAFE_RECT`(w=13, h=7)，强制内容在此范围内。                       | 🔴**高**   |
| **#03**  | **字幕遮挡**           | 底部字幕反复覆盖坐标轴、图表或演职员表。                                         | **图层管理** ：建立 Z-Index 系统，字幕强制在最上层 (`z=100`) 且设有禁飞区。            | 🔴**高**   |
| **#04**  | **组件粗糙**           | 高亮框 (`SurroundingRectangle`) 比例失调，留白过大，像小孩穿大人衣服。         | **智能组件** ：重写 `SmartBox`，根据内容自适应 Padding 和圆角。                        | 🟡 中            |

---

### ⏱️ 二、 分场景临床记录 (Scene-by-Scene Diagnosis)

#### 🎬 Scene 0: 直觉引入 (00:00 - 00:30)

| **时间**  | **症状**       | **诊断**                                           | **V13 修复**                                                       | **严重度** |
| --------------- | -------------------- | -------------------------------------------------------- | ------------------------------------------------------------------------ | ---------------- |
| **00:00** | **摩尔纹闪烁** | 渐变卡片由多个矩形拼接，接缝处渲染出现锯齿。             | **高清贴图** ：使用 `ImageMobject`或无缝拼接技术。               | 🟡 中            |
| **00:10** | **噪声溢出**   | 噪点生成范围超出了白色卡片框，破坏了“图片”的物理隐喻。 | **蒙版裁剪** ：生成范围缩至 90% 或使用 `Intersection`遮罩。      | 🔴**高**   |
| **00:18** | **红线突兀**   | 边缘检测红线出现无过渡，颜色像系统报错。                 | **柔和生长** ：改用琥珀色，添加 `grow_from_center`和透明度渐变。 | 🔴**高**   |
| **00:22** | **布局出界**   | 清晰/噪声/边缘三张大图并列，超出屏幕宽度。               | **演变布局** ：改为“左侧主图+右侧状态灯”的非对称结构。           | 🔴**高**   |

#### 🎬 Scene 1 & 1.5: 连续与离散 (00:31 - 01:29)

| **时间**  | **症状**     | **诊断**                                       | **V13 修复**                                                     | **严重度** |
| --------------- | ------------------ | ---------------------------------------------------- | ---------------------------------------------------------------------- | ---------------- |
| **00:56** | **轴线遮挡** | 底部字幕条压住了 X 轴刻度数字。                      | **布局避让** ：坐标轴整体上移 `UP*0.5`。                       | 🔴**高**   |
| **01:06** | **黑框挡戏** | 巨大的黑色文本框挡住了切线变割线的关键动画。         | **侧边指引** ：移除黑框，改用 `FocusArrow`从侧面指向焦点。     | 🔴**高**   |
| **01:16** | **公式堆砌** | 右侧列出 4 行计算历史，信息密度过大，像 Excel 表格。 | **单一信源** ：只保留一行公式，数值随 `ValueTracker`滚动更新。 | 🔴**高**   |
| **01:20** | **文字重叠** | "Pixel Limit" 黄字与上方算式物理重叠。               | **空间隔离** ：重构右侧面板布局，预留专用提示区。                | 🔴**高**   |
| **01:23** | **框大字小** | 像素限制的警告框太大，且遮挡背景网格。               | **精细化** ：使用 `SmartBox`紧贴文字，半透明背景。             | 🟡 中            |

#### 🎬 Scene 2: 泰勒展开 (01:30 - 02:20)

| **时间**  | **症状**        | **诊断**                                          | **V13 修复**                                                        | **严重度** |
| --------------- | --------------------- | ------------------------------------------------------- | ------------------------------------------------------------------------- | ---------------- |
| **01:30** | **👻 幽灵红叉** | **重大 Bug** ：上一场景的红叉未被清除，残留全场。 | **生命周期** ：在 Scene 1.5 结束时显式 `remove(cross)`。          | 🔴**极高** |
| **01:35** | **误差线难辨**  | 几何误差线太细且与函数撞色（均为冷色调）。              | **视觉反差** ：误差线加粗并改用暖色（琥珀金），背景函数变暗。       | 🟡 中            |
| **01:42** | **公式拖沓**    | 泰勒公式逐字书写 (`Write`) 节奏太慢，且与图形无联系。 | **视觉桥梁** ：让公式项从图形中“飞”出来 (`TransformFromCopy`)。 | 🟡 中            |
| **02:05** | **差分混淆**    | 三种差分方法缺乏明确的主题色区分。                      | **色彩编码** ：前向=橙，后向=红，中心=绿。                          | 🟡 中            |

#### 🎬 Scene 3: Sobel 原理 (02:21 - 03:23)

| **时间**  | **症状**     | **诊断**                                        | **V13 修复**                                                 | **严重度** |
| --------------- | ------------------ | ----------------------------------------------------- | ------------------------------------------------------------------ | ---------------- |
| **02:30** | **波浪晕眩** | 微分噪声的震动幅度过大，全屏乱闪。                    | **克制动效** ：减小 `amplitude`，改用微弱的 `Wiggle`。   | 🟡 中            |
| **02:50** | **数值乱跳** | 卷积计算时数值变化太快，看不清。                      | **节奏控制** ：滑动到特征点时减速停顿 (`there_and_back`)。 | 🟡 中            |
| **03:00** | **图文互挡** | **新发现** ：中间的计算公式与背景图像网格重叠。 | **左右分栏** ：左侧纯图，右侧纯算式，中间留出隔离带。        | 🔴**高**   |
| **03:15** | **结果过暗** | 生成的边缘图像亮度不足，细节丢失。                    | **亮度补偿** ：对结果矩阵应用 Gamma 校正或亮度增强。         | 🟡 中            |

#### 🎬 Scene 4 & 5: 应用与收尾 (03:24 - 结尾)

| **时间**  | **症状**     | **诊断**                                                    | **V13 修复**                                                             | **严重度** |
| --------------- | ------------------ | ----------------------------------------------------------------- | ------------------------------------------------------------------------------ | ---------------- |
| **03:50** | **逻辑反向** | **重大事故** ：扫描框向上移动（爬坡），示波器曲线却向下走。 | **数据同步** ：统一使用 `get_scan_data(t)`函数驱动两者，确保数学一致。 | 🔴**极高** |
| **04:08** | **3D 难辨**  | 流程图强行 3D 侧视，文字透视变形看不清。                          | **回归 2D** ：改为扁平化的高清流程图。                                   | 🔴**高**   |
| **04:20** | **假照片**   | 用 10x10 色块模拟照片，质感低幼。                                 | **高清重制** ：使用 100x100 `ImageMobject`+ 纹理生成。                 | 🟡 中            |
| **04:30** | **转场穿帮** | 旧图未消失，新图直接叠在上面。                                    | **清理逻辑** ：`FadeOut(old)`->`Wait(0.2)`->`FadeIn(new)`。        | 🔴**高**   |
| **04:40** | **矩阵模糊** | 缩放导致线条糊成一团。                                            | **矢量重绘** ：新建针对小尺寸优化的 `Matrix`对象。                     | 🟡 中            |
| **04:50** | **字幕打架** | 演职员表下沉进入字幕区，两层文字重叠。                            | **禁飞区** ：强制演职员表 `y > -2.0`。                                 | 🔴**高**   |

---

这份病历已经包含了你指出的所有问题（含最新的 #26 和 #27）。如果你确认无误，这就是我们 V13 手术的 **最终执行单** 。
